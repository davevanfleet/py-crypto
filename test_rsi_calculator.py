import rsi_calculator
import pytest

MOCK_RESPONSE = [
    [
        1646524800,
        "39396.3",
        "39678.9",
        "38114.2",
        "38416.3",
        "39020.5",
        "2535.06497779",
        24668
    ],
    [
        1646611200,
        "38420.4",
        "39545.0",
        "37159.4",
        "38024.0",
        "38160.4",
        "4162.00634999",
        37775
    ],
    [
        1646697600,
        "38009.8",
        "39373.0",
        "37888.0",
        "38752.6",
        "38672.8",
        "3726.95170728",
        36365
    ],
    [
        1646784000,
        "38752.6",
        "42590.6",
        "38682.0",
        "41965.3",
        "41587.3",
        "5254.01264092",
        48398
    ],
    [
        1646870400,
        "41959.0",
        "42041.8",
        "38576.0",
        "39435.8",
        "39554.0",
        "4643.71243332",
        40582
    ],
    [
        1646956800,
        "39435.8",
        "40222.4",
        "38251.5",
        "38732.1",
        "38996.9",
        "3504.67790685",
        29060
    ],
    [
        1647043200,
        "38727.7",
        "39499.8",
        "38699.0",
        "38785.0",
        "39097.3",
        "1553.27093634",
        15144
    ],
    [
        1647129600,
        "38785.0",
        "39300.0",
        "37593.9",
        "37788.4",
        "38658.3",
        "2300.05265452",
        16962
    ],
    [
        1647216000,
        "37783.7",
        "39899.8",
        "37584.5",
        "39689.2",
        "38903.2",
        "3450.83079618",
        25682
    ],
    [
        1647302400,
        "39689.2",
        "39900.0",
        "38170.0",
        "39325.4",
        "39069.5",
        "2579.94641366",
        22118
    ],
    [
        1647388800,
        "39321.7",
        "41706.8",
        "38807.5",
        "41124.0",
        "40466.2",
        "6599.08148766",
        52075
    ],
    [
        1647475200,
        "41129.9",
        "41469.1",
        "40549.1",
        "40945.6",
        "40907.2",
        "2322.33915065",
        26099
    ],
    [
        1647561600,
        "40941.1",
        "42368.6",
        "40179.1",
        "41775.1",
        "41207.9",
        "2583.79104383",
        30434
    ],
    [
        1647648000,
        "41778.7",
        "42379.6",
        "41537.5",
        "42218.0",
        "41930.6",
        "1298.20726204",
        16785
    ],
    [
        1647734400,
        "42218.0",
        "42308.2",
        "40945.0",
        "41289.0",
        "41389.0",
        "1967.29109207",
        22542
    ],
    [
        1647820800,
        "41286.1",
        "41572.4",
        "40510.1",
        "41014.3",
        "41040.9",
        "1953.95048662",
        22519
    ]
]

def test_rsi_calc():
    assert rsi_calculator.calc(MOCK_RESPONSE) == pytest.approx(58.03, 0.01)
